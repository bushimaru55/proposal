# プロジェクト概要

## システム名
AI営業支援システム

## プロジェクト目的
営業活動を効率化し、データドリブンな提案を可能にするAI営業支援システムの構築

## 主要機能

### 1. ユーザー認証・権限管理
- 管理者/営業マネージャー/営業担当者の3つの役割
- ログイン/ログアウト機能
- ユーザー活動ログ

### 2. 商品管理
- URL/PDF/テキスト入力からの商品情報登録
- 商品カテゴリ管理
- 商品ナレッジベース

### 3. 企業情報取得（必須）
- Webスクレイピングによる自動収集
- AIによる情報構造化
- robots.txt尊重

### 4. CSV分析（オプション）
- CSVファイルアップロード
- AIによるデータ分析
- 分析結果の保存
- **CSV無しでもシステム利用可能**

### 5. 商品マッチング
- 企業情報と商品の自動マッチング
- AIによる適合度判定
- マッチング理由の生成

### 6. トークスクリプト生成
- **セクション選択可能**（オープニング、課題特定、提案、反論処理、クロージング）
- CSV有無による条件分岐
- 商品情報の組み込み
- 商談結果からの学習

### 7. PowerPoint出力
- python-pptxによる生成
- セクション別スライド作成
- ダウンロード機能

### 8. 商談結果管理
- フィードバック記録
- AI学習データとして活用
- 成功パターン分析

### 9. システム設定・プロンプト管理
- 管理画面からの設定変更
- プロンプトテンプレートのバージョン管理
- システム全体のカスタマイズ

## 技術スタック

### バックエンド
- Django 5.0
- Django REST Framework 3.14
- PostgreSQL 16
- Redis 7
- Celery 5.3

### データ処理
- pandas 2.2
- PyPDF2 3.0
- pdfplumber 0.10
- BeautifulSoup4 4.12
- trafilatura 1.7

### AI・出力
- OpenAI API (gpt-4o/gpt-4o-mini)
- python-pptx 0.6

### インフラ
- Docker
- Docker Compose

## システム要件

### 必須要件
- 企業URL入力（Webスクレイピング用）
- OpenAI APIキー
- PostgreSQLデータベース
- Redisサーバー

### オプション要件
- CSVファイル（データ分析用）

## ユーザー役割

### 管理者 (admin)
- 全機能へのアクセス
- ユーザー管理
- 商品管理
- プロンプト設定
- システム設定

### 営業マネージャー (sales_manager)
- データ分析
- トークスクリプト生成
- 商談結果の記録
- レポート閲覧
- 商品情報の閲覧（編集不可）
- 全案件の閲覧

### 営業担当者 (sales_rep)
- 自分の案件のみ閲覧
- トークスクリプト生成
- トレーニングセッション記録
- 商談結果の記録

## セキュリティ

- パスワードハッシュ化（Django標準）
- セッション管理（タイムアウト設定可能）
- CSRFトークン
- SQLインジェクション対策（ORM使用）
- XSS対策（テンプレート自動エスケープ）
- ファイルアップロード検証
- 環境変数での機密情報管理
- ログイン試行回数制限

## パフォーマンス

- Redisキャッシュ活用
- Celeryによる非同期処理
- データベースインデックス
- QuerySet最適化
- 画像・ファイルの適切なストレージ管理

## 開発方針

### 仕様駆動開発
- プロジェクトルート直下の「AIdocs」ディレクトリ内の仕様書を基準
- 実装・修正時は必ずAIdocsを更新
- 変更履歴・理由・影響範囲を記録
- AIdocsと実装の整合性を常に確認・維持

### CSV任意化対応
- Analysis モデルはnullable
- TalkScript生成時にCSV有無をチェック
- CSV無しの場合、データ分析セクションをスキップ
- プロンプトテンプレートに条件分岐を組み込み

### セクション選択機能
- トークスクリプト生成リクエスト時にselected_sectionsを受け取る
- 選択されたセクションのみ生成
- フロントエンドでチェックボックス実装

### 企業URL必須化
- Company作成時のバリデーション
- URLからの自動情報取得フロー
- スクレイピング失敗時のエラーハンドリング

## プロジェクト構成

```
proposal/
├── AIdocs/                      # 仕様書
├── backend/                     # Djangoプロジェクト
│   ├── config/                  # プロジェクト設定
│   ├── apps/                    # Djangoアプリケーション
│   ├── templates/               # テンプレート
│   ├── static/                  # 静的ファイル
│   ├── media/                   # メディアファイル
│   └── requirements.txt         # Pythonパッケージ
├── docker-compose.yml           # Docker構成
└── README.md                    # プロジェクト説明
```

## デプロイメント

### 開発環境
- Docker Compose
- デバッグモード有効
- ローカルファイルストレージ

### 本番環境
- Docker Compose（または Kubernetes）
- デバッグモード無効
- 適切なセキュリティ設定
- ログ管理
- バックアップ体制

## 今後の拡張予定

- ベクトルDB導入（RAG本格実装）
- リアルタイム通知機能
- レポート機能の強化
- モバイル対応
- 多言語対応

